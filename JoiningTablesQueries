Query_1: This is a SQL query that finds the top 10 countries for Rockbuster in terms of customer numbers:

SELECT d.country, COUNT(a.customer_id) AS customer_count
FROM customer a
INNER JOIN address b ON a.address_id = b.address_ID
INNER JOIN city c ON b.city_id = c.city_id
INNER JOIN country d ON c.country_id = d.country_id
GROUP BY d.country
ORDER BY COUNT(a.customer_id) DESC
LIMIT 10;



Query_2: This is a SQL query that finds the top 10 cities within the top 10 countries identified in Query_1:

SELECT c.city, d.country, COUNT(a.customer_id) AS customer_count
FROM customer a
INNER JOIN address b ON a.address_id = b.address_ID
INNER JOIN city c ON b.city_id = c.city_id
INNER JOIN country d ON c.country_id = d.country_id
WHERE d.country IN ('India',
                    'China',
	                  'United States',
	                  'Japan',
	                  'Mexico',
	                  'Brazil',
	                  'Russian Federation',
	                  'Philippines',
	                  'Turkey',
	                  'Indonesia'
	                  )
GROUP BY c.city, d.country
ORDER BY COUNT(a.customer_id) DESC
LIMIT 10;



Query_3: This is a SQL query that finds the top 5 customers in the top 10 cities from Query_2 who have paid the highest total amounts to Rockbuster:

SELECT a.first_name, 
	     a.last_name, 
	     SUM(e.amount) AS highest_pmt,
	     c.city,
	     d.country
FROM payment e
INNER JOIN customer a ON e.customer_id = a.customer_id
INNER JOIN address b ON a.address_id = b.address_ID
INNER JOIN city c ON b.city_id = c.city_id
INNER JOIN country d ON c.country_id = d.country_id
WHERE c.city IN ('Aurora',
	               'Atlicxo',
	               'Xintai',
	               'Adoni',
	               'Dhule (Dhulia)',
	               'Kurashiki',
	               'Pingxiang',
	               'Sivas',
	               'Celaya',
	               'So Leopoldo'
                 )
GROUP BY a.first_name, a.last_name, c.city, d.country
ORDER BY SUM(e.amount) DESC
LIMIT 5;

